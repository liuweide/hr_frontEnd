{"remainingRequest":"D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\src\\components\\UserInfo.vue?vue&type=style&index=0&id=04a5d2c9&lang=less&scoped=true&","dependencies":[{"path":"D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\src\\components\\UserInfo.vue","mtime":1594999941632},{"path":"D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\MyProgram\\SpringBoot+Vue\\人事管理系统\\frontEnd\\hr\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouYXZhdGFyLXVwbG9hZGVyIC5lbC11cGxvYWQgew0KICAgIGJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5Ow0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogIH0NCiAgLmF2YXRhci11cGxvYWRlciAuZWwtdXBsb2FkOmhvdmVyIHsNCiAgICBib3JkZXItY29sb3I6ICM0MDlFRkY7DQogIH0NCiAgLmF2YXRhci11cGxvYWRlci1pY29uIHsNCiAgICBmb250LXNpemU6IDI4cHg7DQogICAgY29sb3I6ICM4YzkzOWQ7DQogICAgd2lkdGg6IDE3OHB4Ow0KICAgIGhlaWdodDogMTc4cHg7DQogICAgbGluZS1oZWlnaHQ6IDE3OHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgfQ0KICAuYXZhdGFyIHsNCiAgICB3aWR0aDogMTc4cHg7DQogICAgaGVpZ2h0OiAxNzhweDsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgfQ0K"},{"version":3,"sources":["UserInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserInfo.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div>\r\n        <!-- 面包屑 -->\r\n        <el-breadcrumb separator=\"/\">\r\n            <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\r\n            <el-breadcrumb-item>设置中心</el-breadcrumb-item>\r\n            <el-breadcrumb-item>个人基本信息</el-breadcrumb-item>\r\n        </el-breadcrumb>\r\n        <el-row>\r\n              <el-col :span=\"10\">\r\n                <el-form ref=\"modifyFormRef\" :model=\"userForm\" label-width=\"110px\" :rules=\"userFormRules\">\r\n                    <el-form-item label=\"用户名：\">\r\n                    <el-input v-model=\"userForm.username\" width=\"100px\"  disabled></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"地址：\" prop=\"address\">\r\n                        <el-input v-model=\"userForm.address\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"电话：\" prop=\"phone\">\r\n                        <el-input v-model=\"userForm.phone\" ></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"邮箱：\" prop=\"email\">\r\n                        <el-input v-model=\"userForm.email\" ></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"所在机构：\">\r\n                        <el-select v-model=\"userForm.unit\" placeholder=\"请选择\" disabled>\r\n                            <el-option\r\n                            v-for=\"item in unitSelect\"\r\n                            :key=\"item.id\"\r\n                            :label=\"item.name\"\r\n                            :value=\"item.id\">\r\n                            </el-option>\r\n                        </el-select>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"岗位：\">\r\n                        <el-select v-model=\"userForm.position\" placeholder=\"请选择\" disabled>\r\n                            <el-option\r\n                            v-for=\"item in postSelect\"\r\n                            :key=\"item.id\"\r\n                            :label=\"item.name\"\r\n                            :value=\"item.id\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item >\r\n                    <span class=\"button_span\">\r\n                        <el-button type=\"primary\" @click=\"modifyUser()\" size=\"small\">修改</el-button>\r\n                    </span>\r\n                    </el-form-item>\r\n                </el-form>\r\n              </el-col>\r\n               <el-col :span=\"10\">\r\n                   <el-upload\r\n                        class=\"avatar-uploader\"\r\n                        action=\"http://localhost:8081/user/upload_photo\"\r\n                        :show-file-list=\"false\"\r\n                        :on-success=\"handleAvatarSuccess\"\r\n                        :before-upload=\"beforeAvatarUpload\">\r\n                        <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\">\r\n                        <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                    </el-upload>\r\n               </el-col>\r\n        </el-row>\r\n    </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data () {\r\n    return {\r\n      userForm: {\r\n        username: '',\r\n        address: '',\r\n        phone: '',\r\n        email: '',\r\n        unit: '',\r\n        position: ''\r\n      },\r\n      unitSelect: [],\r\n      postSelect: [],\r\n      userFormRules: {\r\n        address: [{ required: true, message: '地址不能为空', trigger: 'blur' }],\r\n        phone: [{ required: true, message: '电话不能为空', trigger: 'blur' }],\r\n        email: [{ required: true, message: '邮箱不能为空', trigger: 'blur' }]\r\n      },\r\n      imageUrl: ''\r\n    }\r\n  },\r\n  created () {\r\n    this.getUnitSelect()\r\n    this.getPostSelect()\r\n    this.getUserInfo()\r\n  },\r\n  methods: {\r\n    // 访问后端接口，获取机构下拉框\r\n    getUnitSelect () {\r\n      this.$http.get('/user/getunitbyname?name=&current_index=0&page_size=1000')\r\n        .then(res => {\r\n          // console.log(res.data)\r\n          if (res.data.state === 200) {\r\n            this.unitSelect = res.data.data\r\n          } else {\r\n            this.$message.error('获取机构失败')\r\n          }\r\n        })\r\n        .catch(_error => {\r\n          // console.log(error)\r\n          this.$message.error('获取机构失败')\r\n        })\r\n    },\r\n    // 访问后端，获取岗位下拉\r\n    getPostSelect () {\r\n      this.$http.get('/user/getpost?name=&current_index=0&page_size=1000')\r\n        .then(res => {\r\n          if (res.data.state === 200) {\r\n            // console.log(res.data.data)\r\n            this.postSelect = res.data.data\r\n          } else {\r\n            this.$message.error('获取岗位失败')\r\n          }\r\n        })\r\n        .catch(_error => {\r\n          this.$message.error('获取岗位失败')\r\n        })\r\n    },\r\n    // 获取用户信息\r\n    getUserInfo () {\r\n      // 获取用户信息\r\n      this.$http.get('/user/get_userinfo')\r\n        .then(res => {\r\n          console.log(res.data)\r\n          if (res.data.state === 200) {\r\n            this.userForm = res.data.data\r\n          }\r\n        })\r\n        .catch(_error => {\r\n          this.$message.error('获取用户信息失败' + _error)\r\n        })\r\n    },\r\n    // 修改本人信息\r\n    modifyUser () {\r\n      this.$refs.modifyFormRef.validate(valid => {\r\n        if (valid === true) {\r\n          // 表单验证通过，访问后端接口，修改用户信息\r\n          this.$http.put('/user/modify_userinfo', this.userForm)\r\n            .then(res => {\r\n              if (res.data.state === 200) {\r\n                this.getUserInfo()\r\n                this.$message.success('修改个人信息成功')\r\n              } else {\r\n                this.$message.error('修改个人信息失败')\r\n              }\r\n            })\r\n            .catch(_error => {\r\n              this.$message.error('修改个人信息失败')\r\n            })\r\n        } else {\r\n          // this.getUserInfo()\r\n        }\r\n      })\r\n    },\r\n    handleAvatarSuccess (res, file) {\r\n      this.imageUrl = URL.createObjectURL(file.raw)\r\n    },\r\n    beforeAvatarUpload (file) {\r\n      const isJPG = file.type === 'image/jpeg'\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n\r\n      if (!isJPG) {\r\n        this.$message.error('上传头像图片只能是 JPG 格式!')\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!')\r\n      }\r\n      return isJPG && isLt2M\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.avatar-uploader .el-upload {\r\n    border: 1px dashed #d9d9d9;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n  }\r\n  .avatar-uploader .el-upload:hover {\r\n    border-color: #409EFF;\r\n  }\r\n  .avatar-uploader-icon {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 178px;\r\n    height: 178px;\r\n    line-height: 178px;\r\n    text-align: center;\r\n  }\r\n  .avatar {\r\n    width: 178px;\r\n    height: 178px;\r\n    display: block;\r\n  }\r\n</style>\r\n"]}]}